<div class="max-w-xl mx-auto py-10 fade-in">
  <h1 class="text-4xl font-extrabold text-yellow-400 mb-8 text-center">–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –¢–æ–≤–∞—Ä—É: <%= @product.name %></h1>

  <%# üåü –ü–û–ß–ê–¢–û–ö –ë–õ–û–ö–£ –§–û–†–ú–ò üåü %>
  <%= form_with(model: @product, class: "bg-gray-800 p-8 rounded-xl shadow-2xl") do |form| %>
    
    <% if @product.errors.any? %>
      <div class="bg-red-700 text-white p-4 rounded-lg mb-6">
        <h2 class="font-bold mb-2"><%= pluralize(@product.errors.count, "–ø–æ–º–∏–ª–∫–∞") %> –∑–∞–≤–∞–¥–∏–ª–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—é —Ç–æ–≤–∞—Ä—É:</h2>
        <ul>
          <% @product.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="mb-5">
      <%= form.label :name, "–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É", class: "block text-sm font-medium text-gray-400 mb-2" %>
      <%= form.text_field :name, 
                          class: "w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-gray-100",
                          placeholder: "–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –ö—É—Ä–∞–≥–∞ –î–∂–∞–º–±–æ" %>
    </div>

    <div class="mb-5">
      <%= form.label :description, "–û–ø–∏—Å", class: "block text-sm font-medium text-gray-400 mb-2" %>
      <%= form.text_area :description, 
                           class: "w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-gray-100",
                           placeholder: "–î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Ç–æ–≤–∞—Ä—É",
                           rows: 4 %>
    </div>

    <div class="mb-5">
      <%= form.label :price, "–¶—ñ–Ω–∞ (–∑–∞ –∫–≥/—É–ø–∞–∫–æ–≤–∫—É)", class: "block text-sm font-medium text-gray-400 mb-2" %>
      <%= form.number_field :price, 
                            step: :any,
                            class: "w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-gray-100",
                            placeholder: "–ù–∞–ø—Ä–∏–∫–ª–∞–¥, 150.50" %>
    </div>
    
    <div class="mb-5">
      <%= form.label :category_id, "–ö–∞—Ç–µ–≥–æ—Ä—ñ—è", class: "block text-sm font-medium text-gray-400 mb-2" %>
      
      <div id="existing-category-section">
        <%= form.collection_select :category_id, @categories, :id, :name, 
                                    { prompt: "–û–±–µ—Ä—ñ—Ç—å —ñ—Å–Ω—É—é—á—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é" },
                                    class: "w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-gray-100" %>
      </div>

      <div class="mt-3 flex items-center">
        <input type="checkbox" id="toggle_new_category" class="h-4 w-4 text-yellow-500 border-gray-300 rounded focus:ring-yellow-500">
        <label for="toggle_new_category" class="ml-2 block text-sm text-gray-400">–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</label>
      </div>

      <div id="new-category-section" class="mt-3 hidden">
        <%# üåü –í–ò–ü–†–ê–í–õ–ï–ù–ù–Ø: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ label_tag, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –ø–æ–ª–µ –Ω–µ –Ω–∞–ª–µ–∂–∏—Ç—å –º–æ–¥–µ–ª—ñ %>
        <%= label_tag :new_category_name, "–ù–∞–∑–≤–∞ –Ω–æ–≤–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó", class: "block text-sm font-medium text-gray-400 mb-2" %> 
        
        <%= text_field_tag :new_category_name, nil, 
                           class: "w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-gray-100",
                           placeholder: "–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –Ω–æ–≤–æ—ó –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó" %>
      </div>
    </div>
    
    <div class="mb-6">
      <%= form.label :image_url, "URL –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è", class: "block text-sm font-medium text-gray-400 mb-2" %>
      <%= form.text_field :image_url, 
                          class: "w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg focus:ring-yellow-500 focus:border-yellow-500 text-gray-100",
                          placeholder: "http://example.com/image.jpg" %>
    </div>
    
    <div class="flex justify-between items-center border-t border-gray-700 pt-6">
      <%= form.submit "–û–Ω–æ–≤–∏—Ç–∏ –¢–æ–≤–∞—Ä", class: "bg-yellow-600 text-gray-900 font-bold py-3 px-6 rounded-lg shadow-lg hover:bg-yellow-500 transition duration-300 cursor-pointer" %>
      
      <%= link_to '–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Ç–æ–≤–∞—Ä', product_path(@product), class: "text-gray-500 hover:text-yellow-400 transition duration-300 text-sm" %>
    </div>

  <% end %> <%# üåü –ö–Ü–ù–ï–¶–¨ –ë–õ–û–ö–£ –§–û–†–ú–ò üåü %>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const toggleCheckbox = document.getElementById('toggle_new_category');
      const existingSection = document.getElementById('existing-category-section');
      const newSection = document.getElementById('new-category-section');
      
      // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è DOM-–µ–ª–µ–º–µ–Ω—Ç—ñ–≤
      const categorySelect = existingSection.querySelector('select');
      const newCategoryInput = newSection.querySelector('input[type="text"]');
      
      // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ —ñ—Å–Ω—É—é—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏, –ø–µ—Ä—à –Ω—ñ–∂ –¥–æ–¥–∞–≤–∞—Ç–∏ –æ–±—Ä–æ–±–Ω–∏–∫
      if (toggleCheckbox && existingSection && newSection && categorySelect && newCategoryInput) {
        toggleCheckbox.addEventListener('change', function() {
          if (this.checked) {
            // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –Ω–æ–≤–æ—ó
            existingSection.classList.add('hidden');
            newSection.classList.remove('hidden');
            
            categorySelect.value = '';
            categorySelect.removeAttribute('required');
            newCategoryInput.setAttribute('required', 'required');
          } else {
            // –í–∏–±—ñ—Ä —ñ—Å–Ω—É—é—á–æ—ó
            existingSection.classList.remove('hidden');
            newSection.classList.add('hidden');
            
            newCategoryInput.value = '';
            newCategoryInput.removeAttribute('required');
            // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ required –¥–ª—è –≤–∏–±–æ—Ä—É, —è–∫—â–æ —Ü–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
            // categorySelect.setAttribute('required', 'required'); 
          }
        });
      }
    });
  </script>
  
  <div class="text-center mt-6">
    <%= button_to '–í–∏–¥–∞–ª–∏—Ç–∏ —Ç–æ–≤–∞—Ä', product_path(@product), method: :delete, data: { turbo_confirm: '–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ–π —Ç–æ–≤–∞—Ä?' }, 
                  class: 'text-red-500 hover:text-red-400 transition duration-300 text-sm' %>
  </div>

</div>